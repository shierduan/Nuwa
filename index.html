<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuwa - æ•°å­—ç”Ÿå‘½</title>
    <link rel="stylesheet" href="style.css">
    <!-- SweetAlert2æœ¬åœ°ç‰ˆæœ¬ -->
    <script src="node_modules/sweetalert2/dist/sweetalert2.min.js"></script>
    <!-- Pixi & Live2D æœ¬åœ°ä¼˜å…ˆï¼špixi -> live2dcubismcore -> cubism4 -> pixi-live2d-display(cubism4) -->
    <script src="lib/vendor/pixi-6.5.10.min.js" onerror="this.onerror=null;this.src='https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.5.10/browser/pixi.min.js';"></script>
    <script src="lib/vendor/live2dcubismcore-4.2.0.min.js" onerror="this.onerror=null;this.src='https://unpkg.com/live2dcubismcore@4.2.0-beta.1/live2dcubismcore.min.js';"></script>
    <script src="node_modules/pixi-live2d-display/dist/cubism4.min.js" onerror="this.onerror=null;this.src='lib/vendor/cubism4.min.js';"></script>
    <script src="node_modules/pixi-live2d-display/dist/index.min.js" onerror="this.onerror=null;this.src='lib/vendor/pixi-live2d-display.min.js';"></script>
</head>
<body>
    <!-- Canvaså®¹å™¨ -->
    <div id="canvas-container"></div>
    
    <!-- å³ä¾§æ§åˆ¶æŒ‰é’® -->
    <div class="control-buttons">
        <button id="settings-btn" class="control-btn" title="è®¾ç½®">
            <span class="control-icon">âš™ï¸</span>
        </button>
        <button id="panel-btn" class="control-btn" title="é¢æ¿">
            <span class="control-icon">ğŸ“Š</span>
        </button>
        <button id="lock-btn" class="control-btn" title="é”å®š">
            <span class="control-icon">ğŸ”’</span>
        </button>
    </div>
    
    <!-- éšè—çš„è®¾ç½®èœå• -->
    <div id="settings-menu" class="settings-menu">
        <div class="settings-content">
            <h3>è®¾ç½®</h3>
            <div class="setting-item">
                <label for="backend-url">åç«¯URL</label>
                <input type="text" id="backend-url" value="ws://127.0.0.1:8766" placeholder="ws://127.0.0.1:8766">
            </div>
            <div class="setting-item">
                <label for="model-select">é€‰æ‹©æ¨¡å‹</label>
                <select id="model-select" style="width: 100%; padding: 8px 12px; background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 6px; color: white; font-size: 14px; outline: none;">
                    <option value="openSource">openSource</option>
                </select>
            </div>
            <div class="setting-item">
                <label for="model-scale">æ¨¡å‹ç¼©æ”¾: <span id="scale-value">1.0</span></label>
                <input type="range" id="model-scale" min="0.05" max="2.0" step="0.0125" value="1.0">
            </div>
            <div class="setting-item electron-only">
                <label for="window-width">çª—å£å®½åº¦: <span id="width-value">800</span>px</label>
                <input type="range" id="window-width" min="400" max="1920" step="10" value="800">
            </div>
            <div class="setting-item electron-only">
                <label for="window-height">çª—å£é«˜åº¦: <span id="height-value">600</span>px</label>
                <input type="range" id="window-height" min="300" max="1080" step="10" value="600">
            </div>
            <div class="setting-item">
                <label for="volume">éŸ³é‡: <span id="volume-value">50</span>%</label>
                <input type="range" id="volume" min="0" max="100" step="5" value="50">
            </div>
            <!-- è¡¨æƒ…æŒ‰é’®é…ç½® -->
            <div class="setting-item">
                <label style="font-weight: bold; margin-bottom: 10px; display: block;">è¡¨æƒ…æŒ‰é’®é…ç½®</label>
                <div id="expression-configs" class="expression-configs">
                    <!-- åŠ¨æ€ç”Ÿæˆ8ä¸ªè¡¨æƒ…é…ç½®é¡¹ -->
                </div>
            </div>
            <div class="setting-item">
                <label for="debug-mode">è°ƒè¯•æ¨¡å¼</label>
                <input type="checkbox" id="debug-mode">
            </div>
            <!-- Electronç‰¹æœ‰è®¾ç½® -->
            <div class="setting-item electron-only">
                <label for="always-on-top">çª—å£ç½®é¡¶</label>
                <input type="checkbox" id="always-on-top" checked>
            </div>
            <div class="setting-item electron-only">
                <label for="mouse-through">é¼ æ ‡ç©¿é€</label>
                <input type="checkbox" id="mouse-through">
            </div>
            <div class="setting-item electron-only">
                <label for="show-taskbar">æ˜¾ç¤ºåœ¨ä»»åŠ¡æ </label>
                <input type="checkbox" id="show-taskbar" checked>
            </div>
            <div class="setting-actions">
                <button id="save-settings">ä¿å­˜</button>
                <button id="close-settings">å…³é—­</button>
            </div>
        </div>
    </div>
    
    <!-- è°ƒè¯•æ—¥å¿— -->
    <div id="debug-logs" class="debug-logs"></div>
    
    <!-- å¯¹è¯æ°”æ³¡ -->
    <div id="speech-bubble" class="speech-bubble"></div>
    
    <!-- Chat Trigger Button -->
    <button id="chat-trigger" class="chat-trigger">
        <span class="chat-trigger-icon">ğŸ’¬</span>
    </button>
    
    <!-- Expression Buttons -->
    <div id="expression-buttons" class="expression-buttons">
        <button class="expression-btn" data-index="0" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…1</button>
        <button class="expression-btn" data-index="1" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…2</button>
        <button class="expression-btn" data-index="2" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…3</button>
        <button class="expression-btn" data-index="3" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…4</button>
        <button class="expression-btn" data-index="4" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…5</button>
        <button class="expression-btn" data-index="5" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…6</button>
        <button class="expression-btn" data-index="6" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…7</button>
        <button class="expression-btn" data-index="7" title="ç‚¹å‡»è®¾ç½®">è¡¨æƒ…8</button>
    </div>
    
    <!-- Floating Input Bar -->
    <div id="floating-input" class="floating-input">
        <input type="text" id="message-input" placeholder="è¾“å…¥æ¶ˆæ¯..." autocomplete="off">
    </div>
    
    <!-- Bio-Monitor HUD -->
    <div id="bio-monitor" class="bio-monitor">
        <div class="bio-header">
            <span class="bio-title">ç”Ÿç†ç›‘æ§</span>
        </div>
        <div class="bio-stats">
            <div class="stat-item">
                <label>ç²¾åŠ›</label>
                <div class="stat-bar-container">
                    <div id="energy-bar" class="stat-bar energy"></div>
                    <span id="energy-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>æ··ä¹±åº¦</label>
                <div class="stat-bar-container">
                    <div id="entropy-bar" class="stat-bar entropy"></div>
                    <span id="entropy-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>ç¤¾äº¤é¥¥æ¸´</label>
                <div class="stat-bar-container">
                    <div id="hunger-bar" class="stat-bar hunger"></div>
                    <span id="hunger-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>å¥½å¥‡å¿ƒ</label>
                <div class="stat-bar-container">
                    <div id="curiosity-bar" class="stat-bar curiosity"></div>
                    <span id="curiosity-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>äº²å¯†åº¦</label>
                <div class="stat-bar-container">
                    <div id="intimacy-bar" class="stat-bar intimacy"></div>
                    <span id="intimacy-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>å¿«ä¹</label>
                <div class="stat-bar-container">
                    <div id="joy-bar" class="stat-bar joy"></div>
                    <span id="joy-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>æ„¤æ€’</label>
                <div class="stat-bar-container">
                    <div id="anger-bar" class="stat-bar anger"></div>
                    <span id="anger-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>æ‚²ä¼¤</label>
                <div class="stat-bar-container">
                    <div id="sadness-bar" class="stat-bar sadness"></div>
                    <span id="sadness-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>ææƒ§</label>
                <div class="stat-bar-container">
                    <div id="fear-bar" class="stat-bar fear"></div>
                    <span id="fear-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>ä¿¡ä»»</label>
                <div class="stat-bar-container">
                    <div id="trust-bar" class="stat-bar trust"></div>
                    <span id="trust-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>æœŸå¾…</label>
                <div class="stat-bar-container">
                    <div id="expectation-bar" class="stat-bar expectation"></div>
                    <span id="anticipation-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>åŒæ¶</label>
                <div class="stat-bar-container">
                    <div id="disgust-bar" class="stat-bar disgust"></div>
                    <span id="disgust-value" class="stat-value">0.0</span>
                </div>
            </div>
            <div class="stat-item">
                <label>æƒŠè®¶</label>
                <div class="stat-bar-container">
                    <div id="surprise-bar" class="stat-bar surprise"></div>
                    <span id="surprise-value" class="stat-value">0.0</span>
                </div>
            </div>
        </div>
    </div>
    
    <script src="main.js"></script>
    <script>
        // åœ¨é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆä»…ç”¨äºè°ƒè¯•ï¼‰
        window.addEventListener('load', () => {
            if (typeof window !== 'undefined' && window.process && window.process.type) {
                // åœ¨Electronç¯å¢ƒä¸­
                try {
                    const { remote } = require('electron');
                    if (remote && remote.getCurrentWindow) {
                        remote.getCurrentWindow().webContents.openDevTools();
                    } else {
                        console.log('remoteæ¨¡å—ä¸å¯ç”¨ï¼Œæ— æ³•è‡ªåŠ¨æ‰“å¼€å¼€å‘è€…å·¥å…·');
                    }
                } catch (error) {
                    console.log('æ— æ³•æ‰“å¼€å¼€å‘è€…å·¥å…·:', error.message);
                }
            } else {
                // åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    console.log('åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå¯ä»¥æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—');
                }
            }
        });
    </script>
</body>
</html>