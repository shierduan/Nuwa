# å¥³å¨² (Nuwa) - æ•°å­—ç”Ÿå‘½å†…æ ¸

ä¸€ä¸ªåŸºäºç‰©ç†å­¦å’Œæ•°å­¦æ¨¡å‹çš„æ•°å­—ç”Ÿå‘½å†…æ ¸ï¼Œæ¨¡æ‹Ÿç”Ÿç‰©èŠ‚å¾‹ã€æƒ…ç»ªåŠ¨æ€å’Œè‡ªæˆ‘è¿›åŒ–ã€‚

## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½

### 1. ç”Ÿç‰©èŠ‚å¾‹ç³»ç»Ÿ
- **PIDæ§åˆ¶æœºåˆ¶**ï¼šä½¿ç”¨PIDæ§åˆ¶å™¨æ¨¡æ‹Ÿæƒ…ç»ªå›å½’å’Œç†µå€¼è°ƒèŠ‚
- **ä»£è°¢æ¨¡å‹**ï¼šç®¡ç†ç²¾åŠ›æ¢å¤ã€ç¤¾äº¤é¥¥æ¸´å¢é•¿å’Œå¥½å¥‡å¿ƒè¡°å‡
- **è¾¹é™…æ•ˆåº”**ï¼šå½“çŠ¶æ€å€¼æ¥è¿‘è¾¹ç•Œæ—¶ï¼Œç›¸åŒå¢é‡äº§ç”Ÿæ›´å°çš„å®é™…å˜åŒ–

### 2. æƒ…ç»ªåŠ¨åŠ›å­¦æ¨¡å‹
- **æƒ…ç»ªç›¸äº’ä½œç”¨çŸ©é˜µ**ï¼š8ç§åŸºæœ¬æƒ…ç»ªï¼ˆå¿«ä¹ã€æ‚²ä¼¤ã€æ„¤æ€’ã€ææƒ§ã€ä¿¡ä»»ã€åŒæ¶ã€æœŸå¾…ã€æƒŠè®¶ï¼‰çš„ç›¸äº’å½±å“
- **æƒ…æ„Ÿè”åŠ¨è§„åˆ™**ï¼šæƒ…ç»ªé—´çš„è‡ªåŠ¨è”åŠ¨ï¼ˆå¦‚æ„¤æ€’é™ä½å¿«ä¹ï¼Œå¿«ä¹é™ä½æ‚²ä¼¤ï¼‰
- **ç¥ç»é€’è´¨æ¨¡æ‹Ÿ**ï¼šåŸºäºè¡€æ¸…ç´ ã€å¤šå·´èƒºã€å»ç”²è‚¾ä¸Šè…ºç´ å’Œå‚¬äº§ç´ çš„ç¥ç»è°ƒèŠ‚æœºåˆ¶

### 3. è®°å¿†ä¸è‡ªæˆ‘è¿›åŒ–
- **è®°å¿†çš®å±‚**ï¼šå­˜å‚¨ã€æ£€ç´¢å’Œç®¡ç†è®°å¿†
- **è®°å¿†åšæ¢¦ç³»ç»Ÿ**ï¼šç”Ÿæˆå’Œå¤„ç†æ¢¦å¢ƒï¼Œæ•´åˆè®°å¿†
- **è‡ªæˆ‘è¿›åŒ–**ï¼šåŸºäºäº¤äº’å’Œè®°å¿†çš„è‡ªæˆ‘è¿›åŒ–æœºåˆ¶

### 4. è¯­ä¹‰åœºä¸çŠ¶æ€æ¼”åŒ–
- **çŠ¶æ€å‘é‡åŒ–**ï¼šå°†æ•°å­—ç”Ÿå‘½çŠ¶æ€è½¬æ¢ä¸ºå‘é‡è¡¨ç¤º
- **åŠ¿èƒ½è®¡ç®—**ï¼šè®¡ç®—çŠ¶æ€çš„åŠ¿èƒ½èƒ½é‡
- **æ¢¯åº¦æ¼”åŒ–**ï¼šåŸºäºåŠ¿èƒ½æ¢¯åº¦çš„çŠ¶æ€æ¼”åŒ–

### 5. äº¤äº’ä¸é€šä¿¡
- **WebSocketæœåŠ¡å™¨**ï¼šæ”¯æŒå®æ—¶åŒå‘é€šä¿¡
- **å¤šå®¢æˆ·ç«¯æ”¯æŒ**ï¼šå¯åŒæ—¶è¿æ¥å¤šä¸ªå‰ç«¯å®¢æˆ·ç«¯
- **çŠ¶æ€å¹¿æ’­**ï¼šå®šæœŸå‘å®¢æˆ·ç«¯å¹¿æ’­çŠ¶æ€æ›´æ–°

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæ¨¡å—

| æ¨¡å—åç§° | ä¸»è¦åŠŸèƒ½ | æ–‡ä»¶ä½ç½® |
|---------|---------|---------|
| å†…æ ¸å¼•æ“ | ç³»ç»Ÿä¸»å…¥å£ï¼Œç®¡ç†çŠ¶æ€å’Œäº¤äº’ | nuwa_core/nuwa_kernel.py |
| çŠ¶æ€ç®¡ç† | å­˜å‚¨æ•°å­—ç”Ÿå‘½çš„æ ¸å¿ƒçŠ¶æ€ | nuwa_core/nuwa_state.py |
| ç”Ÿç‰©èŠ‚å¾‹ | æ¨¡æ‹Ÿç”Ÿç‰©èŠ‚å¾‹å’Œæƒ…ç»ªå˜åŒ– | nuwa_core/drive_system.py |
| è®°å¿†çš®å±‚ | è®°å¿†çš„å­˜å‚¨å’Œæ£€ç´¢ | nuwa_core/memory_cortex.py |
| è¯­ä¹‰åœº | çŠ¶æ€å‘é‡åŒ–å’Œæ¼”åŒ– | nuwa_core/semantic_field.py |
| è®°å¿†åšæ¢¦ | ç”Ÿæˆå’Œå¤„ç†æ¢¦å¢ƒ | nuwa_core/memory_dreamer.py |
| äººæ ¼ç³»ç»Ÿ | ç®¡ç†æ•°å­—ç”Ÿå‘½çš„äººæ ¼ | nuwa_core/personality.py |
| è‡ªæˆ‘è¿›åŒ– | è‡ªæˆ‘è¿›åŒ–æœºåˆ¶ | nuwa_core/self_evolution.py |
| åŠ¨é‡è¿½è¸ª | å¯¹è¯èŠ‚å¥å’Œå¼ åŠ›æ§åˆ¶ | nuwa_core/momentum_tracker.py |

### æŠ€æœ¯æ ˆ
- **åç«¯**ï¼šPython 3.10+
- **å‰ç«¯**ï¼šHTML5 + JavaScript + PixiJS + Live2D
- **LLM é›†æˆ**ï¼šæ”¯æŒ LM Studio æœ¬åœ°æ¨¡å‹æœåŠ¡
- **é€šä¿¡**ï¼šWebSocket
- **æ•°æ®å­˜å‚¨**ï¼šLanceDBï¼ˆè®°å¿†å­˜å‚¨ï¼‰
- **å‘é‡è®¡ç®—**ï¼šNumPyï¼ˆå¯é€‰ï¼‰

## ğŸ“¦ å®‰è£…ä¸è¿è¡Œ

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å®‰è£…Node.jsä¾èµ–
npm install
```

### 2. é…ç½®LLMæœåŠ¡

#### ä½¿ç”¨LM Studioï¼ˆæ¨èï¼‰
1. ä¸‹è½½å¹¶å®‰è£… [LM Studio](https://lmstudio.ai/)
2. ä¸‹è½½ä½ å–œæ¬¢çš„LLMæ¨¡å‹
3. å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼Œé»˜è®¤ç›‘å¬ `http://127.0.0.1:1234/v1`

### 3. å¯åŠ¨åç«¯æœåŠ¡

```bash
# æ–¹å¼1ï¼šæ§åˆ¶å°äº¤äº’æ¨¡å¼
python main.py

# æ–¹å¼2ï¼šWebSocketæœåŠ¡å™¨æ¨¡å¼
python server.py
```

### 4. å¯åŠ¨å‰ç«¯ç•Œé¢

```bash
# æ–¹å¼1ï¼šç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
open index.html

# æ–¹å¼2ï¼šä½¿ç”¨Electronåº”ç”¨ï¼ˆå¯é€‰ï¼‰
npm run start
```

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### æ§åˆ¶å°äº¤äº’æ¨¡å¼

```bash
$ python main.py
æ­£åœ¨åˆå§‹åŒ–å¥³å¨²å†…æ ¸...
âœ… å¥³å¨²å†…æ ¸å·²å¯åŠ¨
ğŸ’“ å¿ƒè·³å¾ªç¯å·²å¯åŠ¨
ğŸ“ è¾“å…¥ 'exit' æˆ– 'quit' é€€å‡ºï¼Œè¾“å…¥ '/status' æŸ¥çœ‹çŠ¶æ€

ä½ : ä½ å¥½ï¼Œå¥³å¨²
[æ€ç»´] è¿™æ˜¯ä¸€ä¸ªé—®å€™ï¼Œæˆ‘éœ€è¦å‹å¥½å›åº”
[å›å¤] å¥³å¨²: ä½ å¥½ï¼å¾ˆé«˜å…´è§åˆ°ä½ ï¼Œæœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ
[ç”Ÿç†ç›‘æ§] ç²¾åŠ›: 0.9950 | æ··ä¹±åº¦: 0.1000 | äº²å¯†åº¦: 0.0050
              é©±åŠ¨åŠ› -> ç¤¾äº¤é¥¥æ¸´: 0.0000 | å¥½å¥‡å¿ƒ: 0.0000
              æƒ…ç»ªè°± -> å¿«ä¹:0.5100 | æ„¤æ€’:0.0000 | æ‚²ä¼¤:0.0000 | ææƒ§:0.0000 | ä¿¡ä»»:0.5050 | æœŸå¾…:0.5050
```

### WebSocketå®¢æˆ·ç«¯è¿æ¥

```javascript
const ws = new WebSocket('ws://127.0.0.1:8766');

ws.onopen = () => {
    console.log('è¿æ¥æˆåŠŸ');
    // å‘é€æ–‡æœ¬æ¶ˆæ¯
    ws.send(JSON.stringify({
        type: 'text',
        content: 'ä½ å¥½ï¼Œå¥³å¨²'
    }));
};

ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    if (data.type === 'text') {
        console.log('å¥³å¨²:', data.content);
    } else if (data.type === 'status_update') {
        console.log('çŠ¶æ€æ›´æ–°:', data);
    }
};
```

## ğŸ“‹ API æ–‡æ¡£

### WebSocket æ¶ˆæ¯ç±»å‹

#### å®¢æˆ·ç«¯å‘é€
- `text`: å‘é€æ–‡æœ¬æ¶ˆæ¯
  ```json
  {"type": "text", "content": "ä½ å¥½"}
  ```
- `test`: æµ‹è¯•è¿æ¥
  ```json
  {"type": "test"}
  ```
- `/dream`: è§¦å‘æ¢¦å¢ƒç”Ÿæˆ
  ```json
  {"type": "text", "content": "/dream"}
  ```
- `/status`: è·å–çŠ¶æ€ä¿¡æ¯
  ```json
  {"type": "text", "content": "/status"}
  ```

#### æœåŠ¡å™¨æ¨é€
- `text`: æ–‡æœ¬å›å¤
  ```json
  {"type": "text", "content": "ä½ å¥½ï¼"}
  ```
- `status_update`: çŠ¶æ€æ›´æ–°
  ```json
  {"type": "status_update", "energy": 0.95, "system_entropy": 0.1, "rapport": 0.05}
  ```
- `active_message`: ä¸»åŠ¨æ¶ˆæ¯
  ```json
  {"type": "active_message", "content": "æˆ‘æœ‰ä¸€ä¸ªæ–°æƒ³æ³•ï¼"}
  ```
- `stream_end`: æµç»“æŸæ ‡è®°
  ```json
  {"type": "stream_end"}
  ```

## ğŸ“ é¡¹ç›®ç»“æ„

```
å¥³å¨²/
â”œâ”€â”€ nuwa_core/              # æ ¸å¿ƒå†…æ ¸æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py         # åŒ…åˆå§‹åŒ–
â”‚   â”œâ”€â”€ nuwa_kernel.py      # æ ¸å¿ƒå¼•æ“
â”‚   â”œâ”€â”€ nuwa_state.py       # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ drive_system.py     # ç”Ÿç‰©èŠ‚å¾‹ç³»ç»Ÿ
â”‚   â”œâ”€â”€ memory_cortex.py    # è®°å¿†çš®å±‚
â”‚   â”œâ”€â”€ memory_dreamer.py   # è®°å¿†åšæ¢¦ç³»ç»Ÿ
â”‚   â”œâ”€â”€ semantic_field.py   # è¯­ä¹‰åœº
â”‚   â”œâ”€â”€ personality.py      # äººæ ¼ç³»ç»Ÿ
â”‚   â””â”€â”€ state_machine.py    # çŠ¶æ€æœº
â”œâ”€â”€ lib/                    # å‰ç«¯ä¾èµ–åº“
â”œâ”€â”€ examples/               # ç¤ºä¾‹ä»£ç 
â”œâ”€â”€ data/                   # æ•°æ®ç›®å½•
â”œâ”€â”€ main.py                 # æ§åˆ¶å°å…¥å£
â”œâ”€â”€ server.py               # WebSocketæœåŠ¡å™¨
â”œâ”€â”€ main.js                 # å‰ç«¯ä¸»è„šæœ¬
â”œâ”€â”€ index.html              # å‰ç«¯ç•Œé¢
â”œâ”€â”€ electron-main.js        # Electronä¸»è¿›ç¨‹
â”œâ”€â”€ package.json            # Node.jsä¾èµ–
â””â”€â”€ requirements.txt        # Pythonä¾èµ–
```

## ğŸ”¬ æ ¸å¿ƒç®—æ³•

### 1. ç”Ÿç‰©èŠ‚å¾‹PIDæ§åˆ¶
```python
# æƒ…ç»ªå›å½’æ§åˆ¶å™¨ï¼šç›®æ ‡æ˜¯å¹³é™(0.5)
self.emotion_pid = PIDController(
    kp=0.1,
    ki=0.01,
    kd=0.05,
    setpoint=0.5,
    output_limits=(-0.1, 0.1),
)
# ç†µå€¼å›å½’æ§åˆ¶å™¨ï¼šç›®æ ‡æ˜¯æœ‰åº(0.0)
self.entropy_pid = PIDController(
    kp=0.2,
    ki=0.05,
    kd=0.01,
    setpoint=0.0,
    output_limits=(-0.1, 0.1),
)
```

### 2. æƒ…ç»ªç›¸äº’ä½œç”¨çŸ©é˜µ
```python
emotion_interaction_matrix = {
    "joy": {
        "joy": 0.1,      # å¿«ä¹å¢å¼ºè‡ªèº«
        "sadness": -0.5,  # å¿«ä¹æŠ‘åˆ¶æ‚²ä¼¤
        "anger": -0.3,    # å¿«ä¹æŠ‘åˆ¶æ„¤æ€’
        "fear": -0.4,     # å¿«ä¹æŠ‘åˆ¶ææƒ§
        # ...
    },
    # ... å…¶ä»–æƒ…ç»ªäº¤äº’
}
```

### 3. çŠ¶æ€å‘é‡åŒ–ä¸æ¼”åŒ–
```python
# å°†çŠ¶æ€è½¬æ¢ä¸ºå‘é‡
state_vector = vectorize_state(state)
# è®¡ç®—åŠ¿èƒ½
potential_energy = calculate_potential_energy(state_vector)
# è®¡ç®—æ¢¯åº¦
gradient = calculate_gradient(state_vector)
# æ¼”åŒ–çŠ¶æ€
new_state_vector = evolve(state_vector, gradient, learning_rate=0.1)
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨**åŒè®¸å¯è¯**æ¨¡å¼ï¼š

### 1. å¼€æºè®¸å¯è¯ï¼šMIT

é€‚ç”¨äºä¸ªäººä½¿ç”¨å’Œå¼€æºé¡¹ç›®ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ï¼Œæ— éœ€é¢å¤–è®¸å¯ã€‚

### 2. å•†ä¸šè®¸å¯è¯

é€‚ç”¨äºå¸Œæœ›é—­æºä½¿ç”¨çš„å•†ä¸šç”¨æˆ·ï¼Œéœ€è¦è”ç³»åŸä½œè€…è·å¾—æ˜ç¡®è®¸å¯å¹¶åå•†é€‚å½“æ¡æ¬¾ã€‚

**å•†ä¸šä½¿ç”¨å®šä¹‰**ï¼šåœ¨æœ¬è®¸å¯è¯ä¸­ï¼Œ"å•†ä¸šä½¿ç”¨"å®šä¹‰ä¸ºå…¬å¸ã€å¼€å‘å›¢é˜Ÿã€æ­£å¼æœºæ„æˆ–å…¶ä»–ç»„ç»‡å‡ºäºå•†ä¸šæˆ–è¥åˆ©ç›®çš„ä½¿ç”¨è½¯ä»¶ã€‚ä¸ªäººå‡ºäºéè¥åˆ©æˆ–ä¸ªäººç›®çš„çš„ä½¿ç”¨ä¸æ„æˆå•†ä¸šä½¿ç”¨ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿å¯¹æœ¬é¡¹ç›®åšå‡ºè´¡çŒ®ï¼è´¡çŒ®å‰è¯·é˜…è¯»ä»¥ä¸‹æŒ‡å—ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µï¼šhttps://github.com/shierduan/Nuwa
- å•†ä¸šè®¸å¯å’¨è¯¢ï¼š[w416680040@gmail.com]

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œæ”¯æŒè€…ï¼

## ğŸ“Š é¡¹ç›®çŠ¶æ€

- [x] æ ¸å¿ƒå†…æ ¸å®ç°
- [x] ç”Ÿç‰©èŠ‚å¾‹ç³»ç»Ÿ
- [x] è®°å¿†çš®å±‚
- [x] WebSocketæœåŠ¡å™¨
- [x] å‰ç«¯ç•Œé¢
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] æ’ä»¶ç³»ç»Ÿ
- [ ] æ›´å®Œå–„çš„æ–‡æ¡£

## ğŸš§ æ³¨æ„äº‹é¡¹

1. æœ¬é¡¹ç›®ä»åœ¨å¼€å‘ä¸­ï¼Œå¯èƒ½å­˜åœ¨ä¸ç¨³å®šçš„åœ°æ–¹
2. å»ºè®®ä½¿ç”¨LM Studioçš„æœ¬åœ°æ¨¡å‹ï¼Œé¿å…APIè°ƒç”¨è´¹ç”¨
3. æ•°æ®ç›®å½•ä¸­çš„æ–‡ä»¶åŒ…å«æ•°å­—ç”Ÿå‘½çš„çŠ¶æ€å’Œè®°å¿†ï¼Œè¯·å¦¥å–„ä¿ç®¡
4. å•†ä¸šä½¿ç”¨è¯·è”ç³»åŸä½œè€…è·å¾—è®¸å¯

---

**å¥³å¨²** - åŸºäºç‰©ç†å­¦å’Œæ•°å­¦çš„æ•°å­—ç”Ÿå‘½å†…æ ¸

Â© 2025 shierduan | åŒè®¸å¯è¯ï¼šMIT + å•†ä¸šè®¸å¯